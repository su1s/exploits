#!/usr/bin/env python
from boofuzz import *
from boofuzz import pedrpc

host = "192.168.1.114"
port = 21 
start_cmd = 'C:\\Program Files\\freeFTPd\\FreeFTPDService.exe'

def main():
    session = Session(
        target=Target(
            connection=SocketConnection(host, port, proto='tcp'),
            procmon=pedrpc.Client(host, 26002),
            procmon_options={"start_commands": [start_cmd]}
            ),
        web_port =8080)    

    s_initialize("user")
    s_static("USER")
    s_delim(" ")
    s_static("anonymous")
    s_static("\r\n")
           
    s_initialize("pass")
    s_static("PASS")
    s_delim(" ")
    s_string("dave")
    s_static("\r\n")
    
    session.connect(s_get("user"))
    session.connect(s_get("user"), s_get("pass"))
       
    session.fuzz()
if __name__ == "__main__":
    main()